"use strict";(self.webpackChunktestkube_documentation=self.webpackChunktestkube_documentation||[]).push([[7770],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>g});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var u=a.createContext({}),i=function(e){var t=a.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},c=function(e){var t=i(e.components);return a.createElement(u.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,s=e.originalType,u=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),p=i(n),g=r,k=p["".concat(u,".").concat(g)]||p[g]||d[g]||s;return n?a.createElement(k,l(l({ref:t},c),{},{components:n})):a.createElement(k,l({ref:t},c))}));function g(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var s=n.length,l=new Array(s);l[0]=p;var o={};for(var u in t)hasOwnProperty.call(t,u)&&(o[u]=t[u]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var i=2;i<s;i++)l[i]=n[i];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},55541:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>l,default:()=>d,frontMatter:()=>s,metadata:()=>o,toc:()=>i});var a=n(87462),r=(n(67294),n(3905));const s={sidebar_position:8,sidebar_label:"Gradle"},l="Gradle Based Tests",o={unversionedId:"test-types/executor-gradle",id:"test-types/executor-gradle",title:"Gradle Based Tests",description:"Testkube allows running Gradle based tasks that could be also tests. For example, we can easily run JUnit tests in Testkube.",source:"@site/docs/4-test-types/executor-gradle.md",sourceDirName:"4-test-types",slug:"/test-types/executor-gradle",permalink:"/testkube/test-types/executor-gradle",draft:!1,editUrl:"https://github.com/kubeshop/testkube/docs/docs/4-test-types/executor-gradle.md",tags:[],version:"current",sidebarPosition:8,frontMatter:{sidebar_position:8,sidebar_label:"Gradle"},sidebar:"tutorialSidebar",previous:{title:"Maven",permalink:"/testkube/test-types/executor-maven"},next:{title:"Ginkgo",permalink:"/testkube/test-types/executor-ginkgo"}},u={},i=[{value:"<strong>Test Environment</strong>",id:"test-environment",level:2},{value:"<strong>Create a New Gradle-based Test</strong>",id:"create-a-new-gradle-based-test",level:2},{value:"<strong>Running a Test</strong>",id:"running-a-test",level:2},{value:"<strong>Getting Test Results</strong>",id:"getting-test-results",level:2},{value:"Using Different JDKs",id:"using-different-jdks",level:2},{value:"<strong>Summary</strong>",id:"summary",level:2}],c={toc:i};function d(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"gradle-based-tests"},"Gradle Based Tests"),(0,r.kt)("p",null,"Testkube allows running Gradle based tasks that could be also tests. For example, we can easily run JUnit tests in Testkube. "),(0,r.kt)("h2",{id:"test-environment"},(0,r.kt)("strong",{parentName:"h2"},"Test Environment")),(0,r.kt)("p",null,"We will put a simple JUnit test in our cluster and run it. The Testkube Gradle Executor handles ",(0,r.kt)("inlineCode",{parentName:"p"},"gradle")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"gradlew")," binaries.\nSince Gradle projects are quite complicated in terms of directory structure, we'll need to load them from the Git directory."),(0,r.kt)("p",null,"You can find example projects in the repository here: ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/kubeshop/testkube-executor-gradle/tree/main/examples"},"https://github.com/kubeshop/testkube-executor-gradle/tree/main/examples"),"."),(0,r.kt)("p",null,"Let's create a simple test which will check if an env variable is set to true: "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'package hello.gradle;\n\nimport org.junit.jupiter.api.Test;\nimport static org.junit.jupiter.api.Assertions.*;\n\nclass LibraryTest {\n    @Test void someLibraryMethodReturnsTrue() {\n        String env = System.getenv("TESTKUBE_GRADLE");\n        assertTrue(Boolean.parseBoolean(env), "TESTKUBE_GRADLE env should be true");\n    }\n}\n')),(0,r.kt)("p",null,"The default Gradle executor looks like: "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"apiVersion: executor.testkube.io/v1\nkind: Executor\nmetadata:\n  name: gradle-jdk18-executor\n  namespace: testkube\nspec:\n  image: kubeshop/testkube-gradle-executor:0.1.4-jdk18\n  types:\n  - gradle/project\n  - gradle/test\n  - gradle/integrationTest \n")),(0,r.kt)("p",null,"As we can see, there are several types. The Gradle executor handles the second part after ",(0,r.kt)("inlineCode",{parentName:"p"},"/")," as a task name, so ",(0,r.kt)("inlineCode",{parentName:"p"},"gradle/test")," will run ",(0,r.kt)("inlineCode",{parentName:"p"},"gradle test")," and so on. "),(0,r.kt)("p",null,"As opposed to ",(0,r.kt)("inlineCode",{parentName:"p"},"project")," which is generic and forces you to pass additional arguments during test execution.\nFor example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl testkube run gradle-example-project --args='runMyCustomTask' \n")),(0,r.kt)("h2",{id:"create-a-new-gradle-based-test"},(0,r.kt)("strong",{parentName:"h2"},"Create a New Gradle-based Test")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl testkube create test --git-uri https://github.com/kubeshop/testkube-executor-gradle.git --git-path examples/hello-gradle --type gradle/test --name gradle-example-test --git-branch main\n")),(0,r.kt)("h2",{id:"running-a-test"},(0,r.kt)("strong",{parentName:"h2"},"Running a Test")),(0,r.kt)("p",null,"Let's pass the env variable to our test run:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"}," kubectl testkube run test gradle-example-test -f -v TESTKUBE_GRADLE=true\n\n# ...... after some time\n\nThe test execution completed successfully in 16.555s \ud83e\udd47.\n\nWatch the test execution until complete:\n$ kubectl testkube watch execution 62d148db0260f256c1a1e993\n\n\nUse the following command to get test execution details:\n$ kubectl testkube get execution 62d148db0260f256c1a1e993\n")),(0,r.kt)("h2",{id:"getting-test-results"},(0,r.kt)("strong",{parentName:"h2"},"Getting Test Results")),(0,r.kt)("p",null,"Now we can watch/get test execution details:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl testkube get execution 62d148db0260f256c1a1e993\n")),(0,r.kt)("p",null,"Output:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"# ....... a lot of Gradle logs\n\n> Task :compileTestJava\n> Task :processTestResources NO-SOURCE\n> Task :testClasses\n> Task :test\n\nBUILD SUCCESSFUL in 10s\n2 actionable tasks: 2 executed\n\nStatus Test execution completed with success \ud83e\udd47\n")),(0,r.kt)("h2",{id:"using-different-jdks"},"Using Different JDKs"),(0,r.kt)("p",null,"In the Java world, you would like to have control over the Runtime environment. Testkube can easily handle that for you!\nWe're building several Java images to handle constraints which Gradle can put in its build file."),(0,r.kt)("p",null,"To use a different executor, you can use one of our pre-built ones (for Java 8,11,17,18) or build your own Docker image based on the Gradle executor."),(0,r.kt)("p",null,"Let's assume we need JDK18 for our test runs. In Testkube, create a new Gradle executor:"),(0,r.kt)("p",null,"content of ",(0,r.kt)("inlineCode",{parentName:"p"},"gradle-jdk18-executor.yaml")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"apiVersion: executor.testkube.io/v1\nkind: Executor\nmetadata:\n  name: gradle-jdk18-executor\n  namespace: testkube\nspec:\n  image: kubeshop/testkube-gradle-executor:0.1.4-jdk18\n  types:\n  - gradle:jdk18/project\n  - gradle:jdk18/test\n  - gradle:jdk18/integrationTest \n")),(0,r.kt)("p",null,"And add it to your cluster: "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl apply -f gradle-jdk18-executor.yaml \n")),(0,r.kt)("p",null,"Now, create the new test with the type that our new executor can handle e.g.: ",(0,r.kt)("inlineCode",{parentName:"p"},"gradle:jdk18/test"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"}," # create test:\n kubectl testkube create test --git-uri https://github.com/kubeshop/testkube-executor-gradle.git --git-path examples/hello-gradle-jdk18 --type gradle:jdk18/test --name gradle-jdk18-example-test --git-branch main\n\n# and run it:\nkubectl testkube run test gradle-jdk18-example-test -f -v TESTKUBE_GRADLE=true\n")),(0,r.kt)("h2",{id:"summary"},(0,r.kt)("strong",{parentName:"h2"},"Summary")),(0,r.kt)("p",null,"Testkube simplifies running Java/Kotlin based tests (",(0,r.kt)("inlineCode",{parentName:"p"},"build.gradle.kts")," is also handled) and allows merging Java based tests into your global testing ecosystem easily."))}d.isMDXComponent=!0}}]);